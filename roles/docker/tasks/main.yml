- name: ensure that the community repos are enabled
  lineinfile:
    path: /etc/apk/repositories
    regexp: 'community$'
    line: 'https://dl-4.alpinelinux.org/alpine/v3.9/community'
  tags: provision

- name: add docker
  apk:
    name: docker
    update_cache: True
  register: add_docker
  tags: provision

- name: add docker-py
  pip:
    name: docker
    executable: /usr/bin/pip3

- name: ensure docker starts on reboot
  service:
    name: docker
    enabled: True
    state: started
  tags: provision

- name: add user to docker group
  user:
    name: "{{user_name}}"
    append: True
    groups: docker
